
<meta name="viewport" content="width=device-width, initial-scale=1.0">




<h2>Multitouch Demo for <a href="https://dvcs.w3.org/hg/webevents/raw-file/tip/touchevents.html">Touch events</a>-supporting browsers on Canvas</h2>


<style media="screen"> 
       canvas { border: 1px solid #CCC; }
   </style>
   
   
    <canvas id="example" height=450 width=300></canvas> 
    
    <script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script> 
   <!-- <script src="http://github.com/Modernizr/Modernizr/raw/master/modernizr.js"></script> -->
    
   <script>
           // canvasDrawr originally from Mike Taylr  http://miketaylr.com/
           // Tim Branyen massaged it: http://timbranyen.com/
           // and i did too. with multi touch.
           // and boris fixed some touch identifier stuff to be more specific.
           
           var CanvasDrawr = function(options) {
               // grab canvas element
               var canvas = document.getElementById(options.id),
                   ctxt = canvas.getContext("2d");
                   
               canvas.style.width = '100%'
               canvas.width = canvas.offsetWidth;
               canvas.style.width = '';

               // set props from options, but the defaults are for the cool kids
               ctxt.lineWidth = options.size || Math.ceil(Math.random() * 35);
               ctxt.lineCap = options.lineCap || "round";
               ctxt.pX = undefined;
               ctxt.pY = undefined;

               var lines = [,,];
               var offset = $(canvas).offset();
               
               var self = {
                   //bind click events
                   init: function() {
                       //set pX and pY from first click
                       
                       canvas.addEventListener('touchstart', self.preDraw, false);
                       canvas.addEventListener('touchmove', self.draw, false);
                       
                       
                   },

                   preDraw: function(event) {
                       $.each(event.touches, function(i, touch) {
                         
                           var id = touch.identifier;
                         
                           lines[id] = { x     : this.pageX - offset.left, 
                                         y     : this.pageY - offset.top, 
                                         color : options.color || ["red", "green", "yellow", "blue", "magenta", "orangered"][Math.floor(Math.random() * 6)] 
                                      };
                       });

                       event.preventDefault();
                   },

                   draw: function(event) {
                       var e = event, hmm = {};

                       $.each(event.touches, function(i, touch) {
                           var id = touch.identifier,
                               moveX = this.pageX - offset.left - lines[id].x,
                               moveY = this.pageY - offset.top - lines[id].y;

                           var ret = self.move(id, moveX, moveY);
                           lines[id].x = ret.x;
                           lines[id].y = ret.y;
                       });

                       event.preventDefault();
                   },

                   move: function(i, changeX, changeY) {
                       ctxt.strokeStyle = lines[i].color;
                       ctxt.beginPath();
                       ctxt.moveTo(lines[i].x, lines[i].y);

                       ctxt.lineTo(lines[i].x + changeX, lines[i].y + changeY);
                       ctxt.stroke();
                       ctxt.closePath();

                       return { x: lines[i].x + changeX, y: lines[i].y + changeY };
                   }
               };

               return self.init();
           };

           $(function(){
             var super_awesome_multitouch_drawing_canvas_thingy = new CanvasDrawr({id:"example", size: 5 }); 
           });
   </script>



<Br><br>
  
  
<b>Code by</b> <a href="timbranyen.com">Tim Branyen</a>, <a href="http://miketaylr.com">Mike Taylr</a>,  Paul Irish & <a href=//smus.com>Boris Smus</a>


<br><br>
coming sometime? : <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=508906">firefox multitouch</a> support
